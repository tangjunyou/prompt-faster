# Epic 7 复盘（Retrospective）

- 项目：Prompt Faster
- Epic：7（可靠性与断点续跑）
- 日期：2026-01-19
- 复盘主持：Bob（Scrum Master）
- 参会：耶稣（Project Lead）、Alice（Product Owner）、Charlie（Senior Dev）、Dana（QA Engineer）、Winston（Architect）、Amelia（Dev Agent）

## 1) Epic 概览

- 完成度：4/4 stories（7.1–7.4 全部 done）
- 交付范围：Checkpoint 自动保存、断点恢复、历史回滚、完整历史记录
- 关键门槛：P1–P4 已作为开工门禁执行
- 当前状态：工程可用；Docker smoke check 已完成，但发布就绪证据链仍未完整（外部验收/正式部署未完成）

## 2) 做得好的地方（What went well）

1. **可靠性链路闭环**
   - Checkpoint → 恢复 → 回滚 → 历史时间线形成完整闭环，用户信任感显著提升。
2. **单一历史入口落地**
   - History API 统一口径，避免 iterations/checkpoints 双轨漂移。
3. **质量证据链强化**
   - 关键链路回归测试已覆盖并通过，权限/日志/口径治理有明确规则。

## 3) 遇到的挑战（What didn’t / friction）

1. **口径锁定偏晚**
   - SSOT 与入口收敛在实施中反复补齐，导致返工与修正循环。
2. **兼容期边界复杂**
   - pause_state ↔ Checkpoint 的兼容期规则复杂，牵引多处实现与测试。
3. **规模与性能边界未前置**
   - 导出体量、历史归档边界等问题在后期才被聚焦。

## 4) 关键洞察（Key insights）

- **元凶定位**：跨 Story 的 SSOT/口径没有在开工前被强制锁死为不可破坏契约。
- **可靠性基座**：稳定序列化 + 原子性是可恢复与可追溯的根基。
- **Review 的价值**：真正的改进来自“边界问题前置化”，而非事后补丁。

## 5) 上一 Epic 复盘承诺对账（Epic 6）

- ✅ 跨 Story 硬门禁清单：已落地并贯穿 7.1–7.4
- ⏳ Epic 指标记录机制：仍未闭环
- ⚠️ A3 构建体积告警拆分评估：未体现落地结果
- ✅ pause_state → Checkpoint 收敛设计：已完成并作为门禁执行（兼容期仍需收尾）

## 6) Epic 8 预览与影响

- Epic 8：结果输出与元优化
- 依赖：评估口径一致性、历史/Checkpoint 追溯链路、版本统计口径
- 风险：诊断报告与版本统计可能因口径不一致导致结论偏差
- 结论：**Epic 8 计划需要更新评审**（已加入关键路径）

## 7) 行动项（Action Items）

### CRITICAL（Epic 8 开工前必须完成）
1. **SSOT 开工门禁固化**
   - Owner：Winston + Bob
   - 成功标准：开工前 checklist 固化 + 自动化校验入口可执行并留存记录
   - 类别：Process / Governance
   - 时机：Epic 8 开工前

2. **诊断报告口径与模板规范**
   - Owner：Alice + Paige
   - 成功标准：模板与数据来源映射文档完成并成为规范
   - 类别：Documentation / Product
   - 时机：Epic 8 开工前

3. **版本统计口径一致性（成功率/通过率对齐）**
   - Owner：Charlie + Dana
   - 成功标准：统计口径与历史数据一致，测试可验证
   - 类别：Technical / Quality
   - 时机：Epic 8 开工前

4. **history_events 分支追溯增强**
   - Owner：Winston + Charlie
   - 成功标准：跨分支筛选与追溯可用
   - 类别：Technical / Data
   - 时机：Epic 8 开工前

5. **导出体量治理策略**
   - Owner：Charlie + Dana
   - 成功标准：导出限制/分段/压缩策略明确可执行
   - 类别：Technical / Quality
   - 时机：Epic 8 开工前

6. **结果导出格式与字段规范（Markdown/JSON/XML）**
   - Owner：Alice + Paige
   - 成功标准：多格式字段语义一致并有规范文档
   - 类别：Documentation / Product
   - 时机：Epic 8 开工前

### PARALLEL（与 Epic 8 早期并行，但必须完成）
7. **Epic 指标记录补齐（Epic 7）**
   - Owner：Bob + Alice
   - 成功标准：`epic-metrics-tracker.md` 补齐且口径统一
   - 类别：Process / Metrics

8. **恢复率指标转为验收证据**
   - Owner：Dana
   - 成功标准：恢复率统计口径进入验收/回归依据
   - 类别：Quality / Evidence

9. **A3 构建体积告警拆分评估**
   - Owner：Winston
   - 成功标准：拆分方案形成可执行清单并进入工程计划
   - 类别：Technical Debt / Architecture

10. **内部验收清单（替代外部验收）**
   - Owner：Bob + Dana
   - 成功标准：功能验证 + 可靠性链路演示 + 回滚/恢复演练清单可执行
   - 类别：Process / Quality

11. **Docker 并行部署线**
   - Owner：Winston（负责人）
   - 协作：Charlie（实施）+ Dana（验证）
   - 成功标准：Docker 构建与运行 smoke check 可稳定执行（已完成，见 `docs/implementation-artifacts/docker-smoke-checklist-2026-01-19.md`）
   - 类别：Release / Platform

### NICE-TO-HAVE（不阻塞，但建议完成）
12. **归档边界强化（乱序写入风险防护）**
   - Owner：Charlie
   - 成功标准：归档判定更稳健且有回归测试
   - 类别：Reliability

13. **历史导出风险专项回归**
   - Owner：Dana
   - 成功标准：导出边界/压力验证完成
   - 类别：Quality

## 8) 关键路径（Critical Path）

1. Epic 8 计划更新评审（SSOT/口径/导出规范收敛）
2. SSOT 开工门禁固化
3. 诊断报告口径与模板规范
4. 版本统计口径一致性
5. history_events 分支追溯增强
6. 导出体量治理策略
7. 结果导出格式与字段规范

## 9) 重大变更判断（Significant Discovery）

- 结论：**需要更新 Epic 8 计划**
- 原因：SSOT/口径未形成不可破坏契约、分支追溯不足、导出体量治理缺失
- 决策：已把“Epic 8 计划更新评审”加入关键路径

## 10) 就绪性评估（Readiness Assessment）

- 测试与质量：关键链路测试已通过；覆盖率口径未记录
- 部署状态：本地运行 + Docker smoke check 已完成（`docs/implementation-artifacts/docker-smoke-checklist-2026-01-19.md`）；外部验收与多端部署未执行
- 利益相关方验收：无（以内部验收清单补齐）
- 技术健康：稳定可维护，但存在可预期风险点（分支追溯/导出体量/归档边界/legacy 兼容路径）
- 阻塞项：无明确阻塞；Critical 行动项为启动 Epic 8 的前置条件

## 11) 承诺与下一步（Commitments & Next Steps）

- 执行 CRITICAL 行动项后再启动 Epic 8
- Docker 并行部署线 smoke check 已完成（`docs/implementation-artifacts/docker-smoke-checklist-2026-01-19.md`）
- 内部验收清单作为交付证据链
- Epic 指标记录补齐并形成可复盘口径

---

Bob (Scrum Master): “本次复盘的关键结论是：SSOT 门禁必须前置。我们会把它变成不可破坏的契约。”
